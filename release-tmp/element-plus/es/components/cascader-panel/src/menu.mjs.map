{"version":3,"file":"menu.mjs","sources":["../../../../../../packages/components/cascader-panel/src/menu.vue"],"sourcesContent":["<template>\n  <el-scrollbar :key=\"menuId\" tag=\"ul\" role=\"menu\" :class=\"ns.b()\" :wrap-class=\"ns.e('wrap')\"\n    :view-class=\"[ns.e('list'), ns.is('empty', isEmpty)]\" @mousemove=\"handleMouseMove\" @mouseleave=\"clearHoverZone\">\n    <!-- 全选按钮 -->\n    <div v-if=\"showSelectAll\" :class=\"ns.e('select-all')\" @click=\"handleSelectAll\">\n      <el-checkbox :model-value=\"isAllSelected\" :indeterminate=\"isIndeterminate\"\n        :disabled=\"isAllDisabled || isSelectAllProcessing\" @click.stop @update:model-value=\"handleSelectAllChange\">\n        <template v-if=\"isSelectAllProcessing\">\n          <el-icon size=\"14\" :class=\"ns.is('loading')\">\n            <loading />\n          </el-icon>\n          {{ t('el.cascader.processing') }}\n        </template>\n        <template v-else>\n          {{ selectAllText }}\n        </template>\n      </el-checkbox>\n    </div>\n\n    <!-- <FixedSizeList v-if=\"!isLoading && !isEmpty && !virtualListError\" :height=\"virtualListHeight\"\n      :item-size=\"virtualItemSize\" :data=\"nodes\" :total=\"nodes.length\"\n      :class=\"[ns.e('virtual-list'), 'cascader-virtual-list']\" :scrollbar-always-on=\"false\"\n      @scroll=\"handleVirtualListScroll\" :use-is-scrolling=\"false\" :perf-mode=\"true\" container-element=\"div\"\n      inner-element=\"div\" role=\"listbox\" :aria-label=\"t('el.cascader.options')\" @error=\"handleVirtualListError\"\n      ref=\"virtualListRef\">\n      <template #default=\"{ data, index, style }\" :key=\"virtualListKey\">\n      </template>\n    </FixedSizeList> -->\n\n    <el-cascader-node v-for=\"node in nodes\" :key=\"node.uid\" :node=\"node\" :menu-id=\"menuId\" @expand=\"handleExpand\"\n      @check=\"handleNodeCheck\" :checked=\"isNodeChecked(node.uid)\" :onVnodeMounted=\"() => logRenderNode(node.uid)\" />\n    <!-- <el-cascader-node v-for=\"node in nodes\" :key=\"node.uid\" :node=\"node\" :menu-id=\"menuId\" @expand=\"handleExpand\"\n        :onVnodeMounted=\"() => logRenderNode(node.uid)\" /> -->\n    <div v-if=\"isLoading\" :class=\"ns.e('empty-text')\">\n      <el-icon size=\"14\" :class=\"ns.is('loading')\">\n        <loading />\n      </el-icon>\n      {{ t('el.cascader.loading') }}\n    </div>\n    <div v-else-if=\"isEmpty\" :class=\"ns.e('empty-text')\">\n      <slot name=\"empty\">{{ t('el.cascader.noData') }}</slot>\n    </div>\n    <!-- eslint-disable-next-line vue/html-self-closing -->\n    <svg v-else-if=\"panel?.isHoverMenu\" ref=\"hoverZone\" :class=\"ns.e('hover-zone')\"></svg>\n  </el-scrollbar>\n</template>\n\n<script lang=\"ts\">\nimport { computed, defineComponent, getCurrentInstance, inject, ref, onBeforeUnmount, watch, defineExpose } from 'vue'\nimport ElScrollbar from '@element-plus/components/scrollbar'\nimport { useId, useLocale, useNamespace } from '@element-plus/hooks'\nimport { Loading } from '@element-plus/icons-vue'\nimport ElIcon from '@element-plus/components/icon'\nimport ElCascaderNode from './node.vue'\nimport ElCheckbox from '@element-plus/components/checkbox'\nimport { CASCADER_PANEL_INJECTION_KEY } from './types'\nimport { FixedSizeList } from '@element-plus/components/virtual-list'\n\nimport type { default as CascaderNode } from './node'\nimport type { PropType } from 'vue'\nimport type { Nullable } from '@element-plus/utils'\nimport type { CheckboxValueType } from '@element-plus/components/checkbox'\n\nexport default defineComponent({\n  name: 'ElCascaderMenu',\n\n  components: {\n    Loading,\n    ElIcon,\n    ElScrollbar,\n    ElCascaderNode,\n    FixedSizeList,\n    ElCheckbox,\n  },\n\n  props: {\n    nodes: {\n      type: Array as PropType<CascaderNode[]>,\n      required: true,\n    },\n    index: {\n      type: Number,\n      required: true,\n    },\n    modelValue: {\n      type: Object as PropType<{ allSelected: boolean; exceptions: string[] }>,\n      default: () => ({ allSelected: false, exceptions: [] }),\n    },\n  },\n\n  setup(props, { emit }) {\n    const instance = getCurrentInstance()!\n    const ns = useNamespace('cascader-menu')\n\n    const { t } = useLocale()\n    const id = useId()\n    let activeNode: Nullable<HTMLElement> = null\n    let hoverTimer: Nullable<number> = null\n\n    const panel = inject(CASCADER_PANEL_INJECTION_KEY)!\n\n    const hoverZone = ref<null | SVGSVGElement>(null)\n    const virtualListError = ref(false)\n\n    // 全选性能优化相关状态\n    const selectAllCache = ref<{\n      allNodes: Set<string>\n      checkedNodes: Set<string>\n      lastUpdateTime: number\n      nodeCount: number\n      checkedCount: number\n    }>({\n      allNodes: new Set(),\n      checkedNodes: new Set(),\n      lastUpdateTime: 0,\n      nodeCount: 0,\n      checkedCount: 0\n    })\n\n    // 防抖相关状态\n    const selectAllDebounceTimer = ref<number | null>(null)\n    const isSelectAllProcessing = ref(false)\n\n    const isEmpty = computed(() => !props.nodes.length)\n    const isLoading = computed(() => !panel.initialLoaded)\n    const menuId = computed(() => `${id.value}-${props.index}`)\n\n    // 全选相关计算属性\n    const showSelectAll = computed(() => panel.config.multiple && panel.config.showSelectAll)\n    const selectAllText = computed(() => panel.config.selectAllText || t('el.cascader.selectAll'))\n\n    // 计算全选状态 - 使用缓存优化\n    const selectableNodes = computed(() =>\n      props.nodes.filter(node => !node.isDisabled)\n    )\n\n    const checkedNodes = computed(() =>\n      selectableNodes.value.filter(node => node.checked)\n    )\n\n    const isAllSelected = computed(() =>\n      selectableNodes.value.length > 0 && checkedNodes.value.length === selectableNodes.value.length\n    )\n\n    const isIndeterminate = computed(() =>\n      checkedNodes.value.length > 0 && checkedNodes.value.length < selectableNodes.value.length\n    )\n\n    const isAllDisabled = computed(() =>\n      selectableNodes.value.length === 0\n    )\n\n    // 新增全选标记和例外集合\n    const isAllSelectedFlag = ref(false)\n    const checkedExceptions = ref(new Set<string>())\n\n    // 假设 selectedNodes 是 ref<Set<string>>()，存储已选节点的uid\n    const selectedNodes = ref<Set<string>>(new Set())\n\n    // 判断节点是否选中\n    function isNodeChecked(nodeUid: string) {\n      if (isAllSelectedFlag.value) {\n        return !checkedExceptions.value.has(nodeUid)\n      } else {\n        return checkedExceptions.value.has(nodeUid)\n      }\n    }\n\n    // 全选/取消全选\n    function handleSelectAll(checked: boolean) {\n      isAllSelectedFlag.value = checked\n      checkedExceptions.value.clear()\n      emitSelected()\n\n    }\n\n    // 单个节点选中/取消\n    function handleNodeCheck(nodeUid: string, checked: boolean) {\n      if (isAllSelectedFlag.value) {\n        if (!checked) checkedExceptions.value.add(nodeUid)\n        else checkedExceptions.value.delete(nodeUid)\n      } else {\n        if (checked) checkedExceptions.value.add(nodeUid)\n        else checkedExceptions.value.delete(nodeUid)\n      }\n      emitSelected()\n    }\n\n    // 只 emit 一次事件，避免父组件频繁响应\n    function emitSelected() {\n      if (instance && instance.emit) {\n        instance.emit('update:modelValue', {\n          allSelected: isAllSelectedFlag.value,\n          exceptions: Array.from(checkedExceptions.value)\n        })\n      }\n    }\n\n    // 更新全选缓存\n    const updateSelectAllCache = () => {\n      const now = Date.now()\n      const cache = selectAllCache.value\n      const currentNodes = selectableNodes.value\n\n      // 如果节点数量没有变化且缓存时间在合理范围内，跳过更新\n      if (cache.nodeCount === currentNodes.length &&\n        now - cache.lastUpdateTime < 200) {\n        return\n      }\n\n      const allNodeIds = new Set<string>()\n      const checkedNodeIds = new Set<string>()\n      let checkedCount = 0\n\n      // 收集所有节点和已选中节点\n      const collectNodes = (nodes: CascaderNode[]) => {\n        nodes.forEach(node => {\n          allNodeIds.add(node.uid.toString())\n          if (node.checked) {\n            checkedNodeIds.add(node.uid.toString())\n            checkedCount++\n          }\n          if (node.children && node.children.length > 0) {\n            collectNodes(node.children)\n          }\n        })\n      }\n\n      collectNodes(props.nodes)\n\n      cache.allNodes = allNodeIds\n      cache.checkedNodes = checkedNodeIds\n      cache.lastUpdateTime = now\n      cache.nodeCount = currentNodes.length\n      cache.checkedCount = checkedCount\n    }\n\n    // 批量处理全选/取消全选，分批处理，batchSize=200，且只emit一次事件\n    const batchSelectAll = async (checked: boolean) => {\n      if (isAllDisabled.value || isSelectAllProcessing.value) return\n\n      // 清除之前的防抖定时器\n      if (selectAllDebounceTimer.value) {\n        clearTimeout(selectAllDebounceTimer.value)\n        selectAllDebounceTimer.value = null\n      }\n\n      // 设置防抖，避免快速重复点击\n      selectAllDebounceTimer.value = window.setTimeout(async () => {\n        isSelectAllProcessing.value = true\n        try {\n          updateSelectAllCache()\n          const nodesToProcess = selectableNodes.value\n          if (nodesToProcess.length === 0) return\n          // 分批处理，batchSize=200\n          const batchSize = 200\n          const totalBatches = Math.ceil(nodesToProcess.length / batchSize)\n          for (let i = 0; i < totalBatches; i++) {\n            const start = i * batchSize\n            const end = Math.min(start + batchSize, nodesToProcess.length)\n            const batch = nodesToProcess.slice(start, end)\n            // 只在最后一批 emit 事件，避免父组件频繁响应\n            panel.batchCheckChange(batch, checked, i === totalBatches - 1)\n            if (i < totalBatches - 1) {\n              await new Promise(resolve => requestAnimationFrame(resolve))\n            }\n          }\n          // const endTime = performance.now()\n          // if (process.env.NODE_ENV === 'development') {\n          //   console.log(`[Cascader] 全选操作完成，处理 ${nodesToProcess.length} 个节点，耗时 ${(endTime - startTime).toFixed(2)}ms`)\n          // }\n        } finally {\n          isSelectAllProcessing.value = false\n        }\n      }, 50)\n    }\n\n    // 虚拟列表参数，可根据需要调整\n    // 级联选择器菜单高度为 204px，减去上下内边距 12px (6px * 2)，如果有全选按钮再减去 34px\n    const virtualListHeight = computed(() => {\n      const baseHeight = 192\n      return showSelectAll.value ? baseHeight - 34 : baseHeight\n    })\n    const virtualItemSize = 34\n\n    const handleExpand = (e: MouseEvent) => {\n      activeNode = e.target as HTMLElement\n    }\n\n    const handleMouseMove = (e: MouseEvent) => {\n      if (!panel.isHoverMenu || !activeNode || !hoverZone.value) return\n\n      if (activeNode.contains(e.target as HTMLElement)) {\n        clearHoverTimer()\n\n        const el = instance.vnode.el as HTMLElement\n        const { left } = el.getBoundingClientRect()\n        const { offsetWidth, offsetHeight } = el\n        const startX = e.clientX - left\n        const top = activeNode.offsetTop\n        const bottom = top + activeNode.offsetHeight\n\n        hoverZone.value.innerHTML = `\n          <path style=\"pointer-events: auto;\" fill=\"transparent\" d=\"M${startX} ${top} L${offsetWidth} 0 V${top} Z\" />\n          <path style=\"pointer-events: auto;\" fill=\"transparent\" d=\"M${startX} ${bottom} L${offsetWidth} ${offsetHeight} V${bottom} Z\" />\n        `\n      } else if (!hoverTimer) {\n        hoverTimer = window.setTimeout(\n          clearHoverZone,\n          panel.config.hoverThreshold\n        )\n      }\n    }\n\n    const clearHoverTimer = () => {\n      if (!hoverTimer) return\n      clearTimeout(hoverTimer)\n      hoverTimer = null\n    }\n\n    const clearHoverZone = () => {\n      if (!hoverZone.value) return\n      hoverZone.value.innerHTML = ''\n      clearHoverTimer()\n    }\n\n    const handleVirtualListScroll = (e: Event) => {\n      // 虚拟列表的滚动事件处理\n      // 由于使用了外部的 el-scrollbar，这里主要用于同步滚动状态\n      const target = e.target as HTMLElement\n      if (target && panel.isHoverMenu) {\n        // 在悬停菜单模式下，可能需要处理滚动相关的逻辑\n        clearHoverZone()\n      }\n    }\n\n    const handleVirtualListError = () => {\n      // 虚拟列表出现错误时，降级到普通列表\n      virtualListError.value = true\n    }\n\n    const handleSelectAllChange = (checked: CheckboxValueType) => {\n      if (isAllDisabled.value) return\n\n      batchSelectAll(checked as boolean)\n    }\n\n    // 添加选择的节点\n    function addNode(node: CascaderNode) {\n      console.log('addNode-menu', node)\n      checkedExceptions.value.add(node.uid)\n      if (!panel.config.checkStrictly) {\n        // 递归添加所有子节点\n        // const allNodes = collectAllNodes(node)\n        // allNodes.forEach(n => selectedNodes.value.add(n.uid))\n        // allNodes.push(node)\n      } else {\n        selectedNodes.value.add(node.uid)\n      }\n    }\n\n    // 删除选择的节点\n    function removeNode(node: CascaderNode) {\n      if (!panel.config.checkStrictly) {\n        // 递归移除所有子节点\n        const allNodes = collectAllNodes(node)\n        allNodes.forEach(n => selectedNodes.value.delete(n.uid))\n      } else {\n        selectedNodes.value.delete(node.uid)\n      }\n    }\n\n    // 递归收集所有子节点（包含自身）\n    function collectAllNodes(node: CascaderNode): CascaderNode[] {\n      const result: CascaderNode[] = [node]\n      if (node.children && node.children.length > 0) {\n        node.children.forEach(child => {\n          result.push(...collectAllNodes(child))\n        })\n      }\n      return result\n    }\n\n    // 清理定时器\n    onBeforeUnmount(() => {\n      if (selectAllDebounceTimer.value) {\n        clearTimeout(selectAllDebounceTimer.value)\n        selectAllDebounceTimer.value = null\n      }\n    })\n\n    // 节点渲染性能打印（在模板渲染节点时调用）\n    function logRenderNode(nodeUid: string) {\n      // 这里只做简单打印，实际可统计渲染次数\n      console.log(`[Cascader] 渲染节点: ${nodeUid}`)\n    }\n\n    // watch v-model 同步状态\n    watch(\n      () => props.modelValue,\n      (val) => {\n        if (val && typeof val === 'object') {\n          isAllSelectedFlag.value = !!val.allSelected\n          checkedExceptions.value = new Set(val.exceptions || [])\n        }\n      },\n      { immediate: true }\n    )\n    const virtualListKey = ref(0)\n    const virtualListRef = ref<InstanceType<typeof FixedSizeList>>()\n\n    function updateVirtualListKey() {\n      virtualListKey.value++ // 让 key 变化，强制刷新\n      virtualListRef.value?.forceUpdate()\n    }\n    defineExpose({\n    })\n\n    return {\n      updateVirtualListKey,\n      ns,\n      panel,\n      hoverZone,\n      isEmpty,\n      isLoading,\n      menuId,\n      t,\n      handleExpand,\n      handleMouseMove,\n      clearHoverZone,\n      virtualListHeight,\n      virtualItemSize,\n      handleVirtualListScroll,\n      virtualListError,\n      handleVirtualListError,\n      showSelectAll,\n      selectAllText,\n      selectableNodes,\n      checkedNodes,\n      isAllSelected,\n      isIndeterminate,\n      isAllDisabled,\n      handleSelectAll,\n      handleSelectAllChange,\n      isSelectAllProcessing,\n      isNodeChecked,\n      handleNodeCheck,\n      logRenderNode,\n      selectedNodes,\n    }\n  },\n})\n</script>\n"],"names":["_resolveComponent","_withCtx","_createCommentVNode","_openBlock","_createElementBlock","_createVNode","_withModifiers","_Fragment","_createTextVNode","_toDisplayString","_renderList","_createBlock","_normalizeClass"],"mappings":"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"}