{"version":3,"file":"index.js","sources":["../../../../../../packages/components/cascader-panel/src/index.vue"],"sourcesContent":["<template>\n  <div :class=\"[ns.b('panel'), ns.is('bordered', border)]\" @keydown=\"handleKeyDown\">\n    <el-cascader-menu v-for=\"(menu, index) in menus\" :key=\"index\" :ref=\"(item) => (menuList[index] = item)\"\n      :index=\"index\" :nodes=\"[...menu]\">\n      <template #empty>\n        <slot name=\"empty\" />\n      </template>\n    </el-cascader-menu>\n  </div>\n</template>\n\n<script lang=\"ts\">\n// @ts-nocheck\nimport {\n  computed,\n  defineComponent,\n  nextTick,\n  onBeforeUpdate,\n  onMounted,\n  provide,\n  reactive,\n  ref,\n  watch,\n} from 'vue'\nimport { cloneDeep, flattenDeep, isEqual } from 'lodash-unified'\nimport {\n  castArray,\n  focusNode,\n  getSibling,\n  isClient,\n  isEmpty,\n  scrollIntoView,\n  unique,\n} from '@element-plus/utils'\nimport {\n  CHANGE_EVENT,\n  EVENT_CODE,\n  UPDATE_MODEL_EVENT,\n} from '@element-plus/constants'\nimport { useNamespace } from '@element-plus/hooks'\nimport ElCascaderMenu from './menu.vue'\nimport Store from './store'\nimport Node from './node'\nimport { CommonProps, useCascaderConfig } from './config'\nimport { checkNode, getMenuIndex, sortByOriginalOrder } from './utils'\nimport { CASCADER_PANEL_INJECTION_KEY } from './types'\n\nimport type { PropType } from 'vue'\nimport type { Nullable } from '@element-plus/utils'\nimport type {\n  default as CascaderNode,\n  CascaderNodeValue,\n  CascaderOption,\n  CascaderValue,\n  RenderLabel,\n} from './node'\nimport type { ElCascaderPanelContext } from './types'\n\nexport default defineComponent({\n  name: 'ElCascaderPanel',\n\n  components: {\n    ElCascaderMenu,\n  },\n\n  props: {\n    ...CommonProps,\n    border: {\n      type: Boolean,\n      default: true,\n    },\n    renderLabel: Function as PropType<RenderLabel>,\n  },\n\n  emits: [UPDATE_MODEL_EVENT, CHANGE_EVENT, 'close', 'expand-change'],\n\n  setup(props, { emit, slots }) {\n    // for interrupt sync check status in lazy mode\n    let manualChecked = false\n\n    const ns = useNamespace('cascader')\n    const config = useCascaderConfig(props)\n\n    let store: Nullable<Store> = null\n    const initialLoaded = ref(true)\n    const menuList = ref<any[]>([])\n    const checkedValue = ref<Nullable<CascaderValue>>(null)\n    const menus = ref<CascaderNode[][]>([])\n    const expandingNode = ref<Nullable<CascaderNode>>(null)\n    const checkedNodes = ref<CascaderNode[]>([])\n\n    const isHoverMenu = computed(() => config.value.expandTrigger === 'hover')\n    const renderLabelFn = computed(() => props.renderLabel || slots.default)\n\n    const initStore = () => {\n      const { options } = props\n      const cfg = config.value\n\n      manualChecked = false\n      store = new Store(options, cfg)\n      menus.value = [store.getNodes()]\n\n      if (cfg.lazy && isEmpty(props.options)) {\n        initialLoaded.value = false\n        lazyLoad(undefined, (list) => {\n          if (list) {\n            store = new Store(list, cfg)\n            menus.value = [store.getNodes()]\n          }\n          initialLoaded.value = true\n          syncCheckedValue(false, true)\n        })\n      } else {\n        syncCheckedValue(false, true)\n      }\n    }\n\n    const lazyLoad: ElCascaderPanelContext['lazyLoad'] = (node, cb) => {\n      const cfg = config.value\n      node! = node || new Node({}, cfg, undefined, true)\n      node.loading = true\n\n      const resolve = (dataList: CascaderOption[]) => {\n        const _node = node as Node\n        const parent = _node.root ? null : _node\n        dataList && store?.appendNodes(dataList, parent as any)\n        _node.loading = false\n        _node.loaded = true\n        _node.childrenData = _node.childrenData || []\n        cb && cb(dataList)\n      }\n\n      cfg.lazyLoad(node, resolve as any)\n    }\n\n    const expandNode: ElCascaderPanelContext['expandNode'] = (node, silent) => {\n      const { level } = node\n      const newMenus = menus.value.slice(0, level)\n      let newExpandingNode: Nullable<CascaderNode>\n\n      if (node.isLeaf) {\n        newExpandingNode = node.pathNodes[level - 2]\n      } else {\n        newExpandingNode = node\n        newMenus.push(node.children)\n      }\n\n      if (expandingNode.value?.uid !== newExpandingNode?.uid) {\n        expandingNode.value = node\n        menus.value = newMenus\n        !silent && emit('expand-change', node?.pathValues || [])\n      }\n    }\n\n    const handleCheckChange: ElCascaderPanelContext['handleCheckChange'] = (\n      node,\n      checked,\n      emitClose = true\n    ) => {\n      const { checkStrictly, multiple } = config.value\n      const oldNode = checkedNodes.value[0]\n      manualChecked = true\n\n      !multiple && oldNode?.doCheck(false)\n      node.doCheck(checked)\n      calculateCheckedValue()\n      emitClose && !multiple && !checkStrictly && emit('close')\n      !emitClose && !multiple && !checkStrictly && expandParentNode(node)\n    }\n\n    // 批量处理全选/取消全选 - 性能优化\n    const batchCheckChange: ElCascaderPanelContext['batchCheckChange'] = (\n      nodes,\n      checked,\n      emitClose = true\n    ) => {\n      if (!nodes || nodes.length === 0) return\n\n      const { checkStrictly, multiple } = config.value\n      manualChecked = true\n\n      // 批量设置节点状态，避免重复计算\n      nodes.forEach(node => {\n        if (node.checked !== checked) {\n          if (checkStrictly || !multiple) {\n            node.checked = checked\n          } else {\n            node.doCheck(checked)\n          }\n        }\n      })\n\n      // 只计算一次选中值\n      calculateCheckedValue()\n\n      if (emitClose && !multiple && !checkStrictly) {\n        emit('close')\n      }\n    }\n\n    const expandParentNode = (node) => {\n      if (!node) return\n      node = node.parent\n      expandParentNode(node)\n      node && expandNode(node)\n    }\n\n    const getFlattedNodes = (leafOnly: boolean) => {\n      return store?.getFlattedNodes(leafOnly)\n    }\n\n    const getCheckedNodes = (leafOnly: boolean) => {\n      return getFlattedNodes(leafOnly)?.filter((node) => node.checked !== false)\n    }\n\n    const clearCheckedNodes = () => {\n      checkedNodes.value.forEach((node) => node.doCheck(false))\n      calculateCheckedValue()\n      menus.value = menus.value.slice(0, 1)\n      expandingNode.value = null\n      emit('expand-change', [])\n    }\n\n    const calculateCheckedValue = () => {\n      const { checkStrictly, multiple } = config.value\n      const oldNodes = checkedNodes.value\n      const newNodes = getCheckedNodes(!checkStrictly)!\n      // ensure the original order\n      const nodes = sortByOriginalOrder(oldNodes, newNodes)\n      const values = nodes.map((node) => node.valueByOption)\n      checkedNodes.value = nodes\n      checkedValue.value = multiple ? values : values[0] ?? null\n    }\n\n    const syncCheckedValue = (loaded = false, forced = false) => {\n      const { modelValue } = props\n      const { lazy, multiple, checkStrictly } = config.value\n      const leafOnly = !checkStrictly\n\n      if (\n        !initialLoaded.value ||\n        manualChecked ||\n        (!forced && isEqual(modelValue, checkedValue.value))\n      )\n        return\n\n      if (lazy && !loaded) {\n        const values: CascaderNodeValue[] = unique(\n          flattenDeep(castArray(modelValue))\n        )\n        const nodes = values\n          .map((val) => store?.getNodeByValue(val))\n          .filter((node) => !!node && !node.loaded && !node.loading) as Node[]\n\n        if (nodes.length) {\n          nodes.forEach((node) => {\n            lazyLoad(node, () => syncCheckedValue(false, forced))\n          })\n        } else {\n          syncCheckedValue(true, forced)\n        }\n      } else {\n        const values = multiple ? castArray(modelValue) : [modelValue]\n        const nodes = unique(\n          values.map((val) => store?.getNodeByValue(val, leafOnly))\n        ) as Node[]\n        syncMenuState(nodes, forced)\n        checkedValue.value = cloneDeep(modelValue)\n      }\n    }\n\n    const syncMenuState = (\n      newCheckedNodes: CascaderNode[],\n      reserveExpandingState = true\n    ) => {\n      const { checkStrictly } = config.value\n      const oldNodes = checkedNodes.value\n      const newNodes = newCheckedNodes.filter(\n        (node) => !!node && (checkStrictly || node.isLeaf)\n      )\n      const oldExpandingNode = store?.getSameNode(expandingNode.value!)\n      const newExpandingNode =\n        (reserveExpandingState && oldExpandingNode) || newNodes[0]\n\n      if (newExpandingNode) {\n        newExpandingNode.pathNodes.forEach((node) => expandNode(node, true))\n      } else {\n        expandingNode.value = null\n      }\n\n      oldNodes.forEach((node) => node.doCheck(false))\n      reactive(newNodes).forEach((node) => node.doCheck(true))\n      checkedNodes.value = newNodes\n      nextTick(scrollToExpandingNode)\n    }\n\n    const scrollToExpandingNode = () => {\n      if (!isClient) return\n\n      menuList.value.forEach((menu) => {\n        const menuElement = menu?.$el\n        if (menuElement) {\n          const container = menuElement.querySelector(\n            `.${ns.namespace.value}-scrollbar__wrap`\n          )\n          const activeNode =\n            menuElement.querySelector(\n              `.${ns.b('node')}.${ns.is('active')}:last-child`\n            ) || menuElement.querySelector(`.${ns.b('node')}.in-active-path`)\n          scrollIntoView(container, activeNode)\n        }\n      })\n    }\n\n    const handleKeyDown = (e: KeyboardEvent) => {\n      const target = e.target as HTMLElement\n      const { code } = e\n\n      switch (code) {\n        case EVENT_CODE.up:\n        case EVENT_CODE.down: {\n          e.preventDefault()\n          const distance = code === EVENT_CODE.up ? -1 : 1\n          focusNode(\n            getSibling(target, distance, `.${ns.b('node')}[tabindex=\"-1\"]`)\n          )\n          break\n        }\n        case EVENT_CODE.left: {\n          e.preventDefault()\n          const preMenu = menuList.value[getMenuIndex(target) - 1]\n          const expandedNode = preMenu?.$el.querySelector(\n            `.${ns.b('node')}[aria-expanded=\"true\"]`\n          )\n          focusNode(expandedNode)\n          break\n        }\n        case EVENT_CODE.right: {\n          e.preventDefault()\n          const nextMenu = menuList.value[getMenuIndex(target) + 1]\n          const firstNode = nextMenu?.$el.querySelector(\n            `.${ns.b('node')}[tabindex=\"-1\"]`\n          )\n          focusNode(firstNode)\n          break\n        }\n        case EVENT_CODE.enter:\n        case EVENT_CODE.numpadEnter:\n          checkNode(target)\n          break\n      }\n    }\n    function addNodeByValue(values: CascaderNodeValue[]) {\n      if (!store) return\n      if (!Array.isArray(values)) {\n        console.warn('参数必须为数组')\n        return\n      }\n      const nodes = values.map(value => store.getNodeByValue(value)).filter(Boolean)\n      if (nodes.length === 0) {\n        console.warn('未找到对应节点')\n        return\n      }\n      function checkNodeRecursively(node: CascaderNode) {\n        node.doCheck(true)\n      }\n      for (const node of nodes) {\n        checkNodeRecursively(node)\n      }\n      calculateCheckedValue()\n      // values.forEach(node => checkNodeRecursively(node))\n      menus.value = [...menus.value] // 搭配onVnodeMounted  强制更新视图\n    }\n    function removeNodeByValue(values: CascaderNodeValue[]) {\n      if (!store) return\n      if (!Array.isArray(values)) {\n        console.warn('参数必须为数组')\n        return\n      }\n      const nodes = values.map(value => store.getNodeByValue(value)).filter(Boolean)\n      if (nodes.length === 0) {\n        console.warn('未找到对应节点')\n        return\n      }\n      function checkNodeRecursively(node: CascaderNode) {\n        node.doCheck(false)\n      }\n      for (const node of nodes) {\n        checkNodeRecursively(node)\n      }\n      // values.forEach(node => checkNodeRecursively(node))\n      calculateCheckedValue()\n      menus.value = [...menus.value] // 搭配onVnodeMounted  强制更新视图\n    }\n\n    // 手动触发\n    function triggerCheckChange() {\n      calculateCheckedValue()\n      emit(CHANGE_EVENT, checkedNodes.value)\n    }\n\n    provide(\n      CASCADER_PANEL_INJECTION_KEY,\n      reactive({\n        config,\n        expandingNode,\n        checkedNodes,\n        isHoverMenu,\n        initialLoaded,\n        renderLabelFn,\n        lazyLoad,\n        expandNode,\n        handleCheckChange,\n        batchCheckChange,\n        triggerCheckChange,\n      })\n    )\n\n    watch([config, () => props.options], initStore, {\n      deep: true,\n      immediate: true,\n    })\n\n    watch(\n      () => props.modelValue,\n      () => {\n        manualChecked = false\n        syncCheckedValue()\n      },\n      {\n        deep: true,\n      }\n    )\n\n    watch(\n      () => checkedValue.value,\n      (val) => {\n        if (!isEqual(val, props.modelValue)) {\n          emit(UPDATE_MODEL_EVENT, val)\n          emit(CHANGE_EVENT, val)\n        }\n      }\n    )\n\n    onBeforeUpdate(() => (menuList.value = []))\n\n    onMounted(() => !isEmpty(props.modelValue) && syncCheckedValue())\n\n\n    return {\n      addNodeByValue, // 暴露方法\n      removeNodeByValue, // 暴露方法\n      ns,\n      menuList,\n      menus,\n      checkedNodes,\n      handleKeyDown,\n      handleCheckChange,\n      getFlattedNodes,\n      /**\n       * @description get an array of currently selected node,(leafOnly) whether only return the leaf checked nodes, default is `false`\n       */\n      getCheckedNodes,\n      /**\n       * @description clear checked nodes\n       */\n      clearCheckedNodes,\n      calculateCheckedValue,\n      scrollToExpandingNode,\n    }\n  },\n})\n</script>\n"],"names":["defineComponent","ElCascaderMenu","CommonProps","UPDATE_MODEL_EVENT","CHANGE_EVENT","useNamespace","config","useCascaderConfig","store","ref","computed","Store","isEmpty","node","Node","sortByOriginalOrder","isEqual","unique","flattenDeep","castArray","cloneDeep","reactive","nextTick","scrollIntoView","EVENT_CODE","getSibling","getMenuIndex","focusNode","checkNode","provide","CASCADER_PANEL_INJECTION_KEY","watch","onBeforeUpdate","onMounted","_resolveComponent","_openBlock","_createElementBlock","_normalizeClass","_Fragment","_renderList","_createBlock","_withCtx","_renderSlot","_export_sfc"],"mappings":"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"}